Программа имеет две проблемы, одна из которых потеря данных при работе с ссылками(sort.cpp)
Вторая проблемв работа не проверена преподвателоем. Остальное всё вроде норм
